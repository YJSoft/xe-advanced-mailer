<load target="css/config.css" />
<load target="js/config.js" />

<div class="x_page-header">
	<h1>{$lang->cmd_advanced_mailer}</h1>
</div>

<form class="x_form-horizontal" action="./" method="post">
	<input type="hidden" name="module" value="advanced_mailer" />
	<input type="hidden" name="act" value="procAdvanced_mailerAdminInsertConfig" />
	<input type="hidden" name="success_return_url" value="{getRequestUriByServerEnviroment()}" />
	
	<div cond="$XE_VALIDATOR_MESSAGE" class="message {$XE_VALIDATOR_MESSAGE_TYPE}">
		<p>{$XE_VALIDATOR_MESSAGE}</p>
	</div>
	
	<section class="section">
		
		<h2 style="padding-top:12px">{$lang->cmd_advanced_mailer_sending_method}</h2>
		
		<div class="advanced_mailer_description">
			※ {$lang->cmd_advanced_mailer_about_sending_method}
		</div>
		
		<div class="x_control-group">
			<label class="x_control-label" for="advanced_mailer_send_type">{$lang->cmd_advanced_mailer_send_type}</label>
			<div class="x_controls">
				<select name="send_type" id="advanced_mailer_send_type">
					<option value="mail" selected="selected"|cond="$advanced_mailer_config->send_type === 'mail'">{$lang->cmd_advanced_mailer_send_type_mail}</option>
					<option value="smtp" selected="selected"|cond="$advanced_mailer_config->send_type === 'smtp'">{$lang->cmd_advanced_mailer_send_type_smtp}</option>
					<option value="ses" selected="selected"|cond="$advanced_mailer_config->send_type === 'ses'">{$lang->cmd_advanced_mailer_send_type_ses}</option>
					<option value="mailgun" selected="selected"|cond="$advanced_mailer_config->send_type === 'mailgun'">{$lang->cmd_advanced_mailer_send_type_mailgun}</option>
					<option value="mandrill" selected="selected"|cond="$advanced_mailer_config->send_type === 'mandrill'">{$lang->cmd_advanced_mailer_send_type_mandrill}</option>
					<option value="postmark" selected="selected"|cond="$advanced_mailer_config->send_type === 'postmark'">{$lang->cmd_advanced_mailer_send_type_postmark}</option>
					<option value="sendgrid" selected="selected"|cond="$advanced_mailer_config->send_type === 'sendgrid'">{$lang->cmd_advanced_mailer_send_type_sendgrid}</option>
					<option value="woorimail" selected="selected"|cond="$advanced_mailer_config->send_type === 'woorimail'">{$lang->cmd_advanced_mailer_send_type_woorimail}</option>
				</select>
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="smtp">
			<label class="x_control-label" for="advanced_mailer_smtp_host">{$lang->cmd_advanced_mailer_smtp_host}</label>
			<div class="x_controls">
				<input type="text" name="smtp_host" id="advanced_mailer_smtp_host" value="{$advanced_mailer_config->smtp_host}" />
				<select id="advanced_mailer_smtp_manual_entry">
					<option value="">{$lang->cmd_advanced_mailer_smtp_manual_entry}</option>
					<option value="gmail">Gmail</option>
					<option value="hanmail">Hanmail</option>
					<option value="naver">Naver</option>
					<option value="naver_works">Naver Works</option>
					<option value="outlook">Outlook.com</option>
					<option value="yahoo">Yahoo</option>
				</select>
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="smtp">
			<label class="x_control-label" for="advanced_mailer_smtp_port">{$lang->cmd_advanced_mailer_smtp_port}</label>
			<div class="x_controls">
				<input type="text" name="smtp_port" id="advanced_mailer_smtp_port" value="{$advanced_mailer_config->smtp_port}" />
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="smtp">
			<label class="x_control-label">{$lang->cmd_advanced_mailer_smtp_security}</label>
			<div class="x_controls">
				<label class="x_inline" for="advanced_mailer_smtp_security_none"><input type="radio" name="smtp_security" id="advanced_mailer_smtp_security_none" value="none" checked="checked"|cond="!in_array($advanced_mailer_config->smtp_security, array('ssl', 'tls'))" /> {$lang->cmd_advanced_mailer_smtp_security_none}</label>
				<label class="x_inline" for="advanced_mailer_smtp_security_ssl"><input type="radio" name="smtp_security" id="advanced_mailer_smtp_security_ssl" value="ssl" checked="checked"|cond="$advanced_mailer_config->smtp_security === 'ssl'" /> {$lang->cmd_advanced_mailer_smtp_security_ssl}</label>
				<label class="x_inline" for="advanced_mailer_smtp_security_tls"><input type="radio" name="smtp_security" id="advanced_mailer_smtp_security_tls" value="tls" checked="checked"|cond="$advanced_mailer_config->smtp_security === 'tls'" /> {$lang->cmd_advanced_mailer_smtp_security_tls}</label>
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="smtp sendgrid">
			<label class="x_control-label" for="advanced_mailer_username">{$lang->cmd_advanced_mailer_username}</label>
			<div class="x_controls">
				<input type="text" name="username" id="advanced_mailer_username" value="{$advanced_mailer_config->username}" />
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="smtp sendgrid">
			<label class="x_control-label" for="advanced_mailer_password">{$lang->cmd_advanced_mailer_password}</label>
			<div class="x_controls">
				<input type="password" name="password" id="advanced_mailer_password" value="{$advanced_mailer_config->password}" />
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="mailgun woorimail">
			<label class="x_control-label" for="advanced_mailer_domain">{$lang->cmd_advanced_mailer_domain}</label>
			<div class="x_controls">
				<input type="text" name="domain" id="advanced_mailer_domain" value="{$advanced_mailer_config->domain}" />
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="mailgun mandrill postmark woorimail">
			<label class="x_control-label" for="advanced_mailer_api_key">{$lang->cmd_advanced_mailer_api_key}</label>
			<div class="x_controls full-width">
				<input type="text" name="api_key" id="advanced_mailer_api_key" value="{$advanced_mailer_config->api_key}" />
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="woorimail">
			<label class="x_control-label">{$lang->cmd_advanced_mailer_account_type}</label>
			<div class="x_controls full-width">
				<label class="x_inline" for="advanced_mailer_account_type_free"><input type="radio" name="account_type" id="advanced_mailer_account_type_free" value="free" checked="checked"|cond="$advanced_mailer_config->account_type !== 'paid'" /> {$lang->cmd_advanced_mailer_free_account}</label>
				<label class="x_inline" for="advanced_mailer_account_type_paid"><input type="radio" name="account_type" id="advanced_mailer_account_type_paid" value="paid" checked="checked"|cond="$advanced_mailer_config->account_type === 'paid'" /> {$lang->cmd_advanced_mailer_paid_account}</label>
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="ses">
			<label class="x_control-label" for="advanced_mailer_aws_region">{$lang->cmd_advanced_mailer_aws_region}</label>
			<div class="x_controls full-width">
				<select name="aws_region" id="advanced_mailer_aws_region">
					<option value="us-east-1" selected="selected"|cond="$advanced_mailer_config->aws_region === 'us-east-1'">us-east-1 (N. Virginia)</option>
					<option value="us-west-2" selected="selected"|cond="$advanced_mailer_config->aws_region === 'us-west-2'">us-west-2 (Oregon)</option>
					<option value="eu-west-1" selected="selected"|cond="$advanced_mailer_config->aws_region === 'eu-west-1'">eu-west-1 (Ireland)</option>
				</select>
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="ses">
			<label class="x_control-label" for="advanced_mailer_aws_access_key">{$lang->cmd_advanced_mailer_aws_access_key}</label>
			<div class="x_controls full-width">
				<input type="text" name="aws_access_key" id="advanced_mailer_aws_access_key" value="{$advanced_mailer_config->aws_access_key}" />
			</div>
		</div>
		
		<div class="x_control-group hidden-by-default" data-visible-types="ses">
			<label class="x_control-label" for="advanced_mailer_aws_secret_key">{$lang->cmd_advanced_mailer_aws_secret_key}</label>
			<div class="x_controls full-width">
				<input type="password" name="aws_secret_key" id="advanced_mailer_aws_secret_key" value="{$advanced_mailer_config->aws_secret_key}" />
			</div>
		</div>
		
	</section>
	
	<section class="section">
		
		<h2 style="padding-top:12px">{$lang->cmd_advanced_mailer_sender_identity}</h2>
		
		<div class="advanced_mailer_description">
			※ {$lang->cmd_advanced_mailer_about_sender_identity}
		</div>
		
		<div class="x_control-group">
			<label class="x_control-label" for="advanced_mailer_sender_name">{$lang->cmd_advanced_mailer_sender_name}</label>
			<div class="x_controls">
				<input type="text" name="sender_name" id="advanced_mailer_sender_name" value="{$webmaster_name}" />
			</div>
		</div>
		
		<div class="x_control-group">
			<label class="x_control-label" for="advanced_mailer_sender_email">{$lang->cmd_advanced_mailer_sender_email}</label>
			<div class="x_controls">
				<input type="text" name="sender_email" id="advanced_mailer_sender_email" value="{$webmaster_email}" />
			</div>
		</div>
	
		<div class="x_control-group">
			<label class="x_control-label" for="advanced_mailer_reply_to">{$lang->cmd_advanced_mailer_reply_to}</label>
			<div class="x_controls">
				<input type="text" name="reply_to" id="advanced_mailer_reply_to" value="{$advanced_mailer_config->reply_to}" />
			</div>
		</div>
	
	</section>
	
	<div class="btnArea x_clearfix">
		<button type="submit" class="x_btn x_btn-primary x_pull-right">{$lang->cmd_registration}</button>
	</div>
	
	<section class="section" id="spf_dkim_setting"
		data-server-ip="{$advanced_mailer_server_ip}"
		data-ellipsis="{$lang->cmd_advanced_mailer_ellipsis}"
		data-nothing-to-check="{$lang->cmd_advanced_mailer_nothing_to_check}"
		data-check-failure="{$lang->cmd_advanced_mailer_check_failure}"
		data-check-no-records="{$lang->cmd_advanced_mailer_check_no_records}"
		data-check-result="{$lang->cmd_advanced_mailer_check_result}"
		data-other-mail-spf="{htmlspecialchars($lang->cmd_advanced_mailer_other_info_mail_spf)}"
		data-other-ses-dkim="{htmlspecialchars($lang->cmd_advanced_mailer_other_info_ses_dkim)}"
		data-other-mailgun-dkim="{htmlspecialchars($lang->cmd_advanced_mailer_other_info_mailgun_dkim)}"
		data-other-postmark-dkim="{htmlspecialchars($lang->cmd_advanced_mailer_other_info_postmark_dkim)}">
		
		<h2 style="padding-top:12px">{$lang->cmd_advanced_mailer_spf_dkim_setting}</h2>
		
		<div class="advanced_mailer_description">
			※ {$lang->cmd_advanced_mailer_about_spf_dkim_setting}
		</div>
		
		<div class="x_control-group">
			<label class="x_control-label">SPF</label>
			<div class="x_controls">
				<div class="not_applicable spf">{$lang->cmd_advanced_mailer_not_applicable}</div>
				<div class="config_description spf">{$lang->cmd_advanced_mailer_dns_hostname} <span class="hostname"></span> &nbsp; <a href="#" id="advanced_mailer_check_spf">{$lang->cmd_advanced_mailer_check}</a></div>
				<div class="config_value spf">{$lang->cmd_advanced_mailer_txt_record} <span class="value"></span></div>
				<div class="config_other spf">{$lang->cmd_advanced_mailer_other_info} <span class="other"></span></div>
			</div>
		</div>
		
		<div class="x_control-group">
			<label class="x_control-label">DKIM</label>
			<div class="x_controls">
				<div class="not_applicable dkim">{$lang->cmd_advanced_mailer_not_applicable}</div>
				<div class="config_description dkim">{$lang->cmd_advanced_mailer_dns_hostname} <span class="hostname"></span> &nbsp; <a href="#" id="advanced_mailer_check_dkim">{$lang->cmd_advanced_mailer_check}</a></div>
				<div class="config_value dkim">{$lang->cmd_advanced_mailer_txt_record} <span class="value"></span></div>
				<div class="config_other dkim">{$lang->cmd_advanced_mailer_other_info} <span class="other"></span></div>
			</div>
		</div>
		
	<section class="section">
		
		<h2>{$lang->cmd_advanced_mailer_test}</h2>
		
		<div class="advanced_mailer_description">
			※ {$lang->cmd_advanced_mailer_about_test}
		</div>
		
		<div class="x_control-group">
			<label class="x_control-label" for="advanced_mailer_recipient_name">{$lang->cmd_advanced_mailer_recipient_name}</label>
			<div class="x_controls">
				<input type="text" id="advanced_mailer_recipient_name" value="" />
			</div>
		</div>
		
		<div class="x_control-group">
			<label class="x_control-label" for="advanced_mailer_recipient_email">{$lang->cmd_advanced_mailer_recipient_email}</label>
			<div class="x_controls">
				<input type="text" id="advanced_mailer_recipient_email" value="" />
				<button id="advanced_mailer_test_send" type="button">{$lang->cmd_advanced_mailer_send}</button>
			</div>
		</div>
		
		<div class="x_control-group">
			<label class="x_control-label">{$lang->cmd_advanced_mailer_test_result}</label>
			<div class="x_controls">
				<div id="advanced_mailer_test_result"></div>
			</div>
		</div>
		
	</section>
	
</form>
